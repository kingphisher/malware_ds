Malware Data Science - Chapter 1
Basic Static Malware Analysis

Overview
  Static analysis performed by analyzing a program's on-disk resources.
    # On-disk resources:
      - disassembled code
      - graphical images
      - printable strings
      - etc
  It refers to reverse engineering without actually running the program.


The Microsoft Windows Portable Executable Format
  PE format describes the structure of modern Windows program files and defines the way they store data.
    # Program files:
      - .exe
      - .dll
      - .sys
  PE format includes a series of headers telling the operating system how to load a program into memory.
    # Headers:
      - DOS header
      - PE header
      - Optional header
      - Section headers
  It also includes a series of sections that contain the actual program data.
    # Sections:
      - .text section (program code)
      - .idata section (imported libraries)
      - .rsrc section (strings, images, etc)
      - .reloc section (memory translation)
ã€€
  @ PE Header
      Defines a program's general attributes:
      - Binary code
      - Images
      - Compressed data
      - etc.
  @ Optional Header
      Defines the location of a program's entry point in the PE file, which refers to the first instruction the program runs once loaded.
      It also defines the size of the data that Windows loads into memory.
  @ Section Headers
      Section headers describe the data sections contained within a PE file.
      A section in a PE file is a chunk of data that either will be:
        - Mapped into memory when the operating system loads a program.
        - Contain instructions about how the program should be loaded into memory.
  @ .text Section
      Each PE program contains at least one section of x86 code marked executable in its section header;
      These section are almost always named .text
  @ .idata Section
      Also called imports, contains the Import Address Table (IAT), which lists dynamically linked libraries and their functions.
  @ Data Sections
      Include section like:
        - .rsrc
        - .data
        - .rdata
      Store items such as:
        - Mouse cursor image
        - Button skins
        - Audio
        - Other media used by a program
  @ .reloc Section
      It tells the Windows operating system to translate memory addresses in a PE file's code if the code has been moved.